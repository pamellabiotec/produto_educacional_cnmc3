<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChemMatrix RPG - Aventura Cient√≠fica</title>
    <link rel="icon" href="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/f9542282-3bbe-4c6a-af46-ea52a3ca0719.png" type="image/png">
    <meta name="description" content="RPG Interativo para aprender Qu√≠mica: Petr√≥leo, Pol√≠meros e Radioatividade">
    <meta name="author" content="Prof.¬™ P√¢mella A. Balca√ßar">
    <meta name="keywords" content="qu√≠mica, educa√ß√£o, RPG, petr√≥leo, pol√≠meros, radioatividade, BNCC">
    
    <style>
        :root {
            /* Primitive Color Tokens */
            --color-white: rgba(255, 255, 255, 1);
            --color-black: rgba(0, 0, 0, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-teal-800: rgba(41, 150, 161, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-orange-400: rgba(230, 129, 97, 1);
            --color-orange-500: rgba(168, 75, 47, 1);

            /* RGB versions for opacity control */
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-slate-500-rgb: 98, 108, 113;
            --color-red-500-rgb: 192, 21, 47;
            --color-red-400-rgb: 255, 84, 89;
            --color-orange-500-rgb: 168, 75, 47;
            --color-orange-400-rgb: 230, 129, 97;

            /* Background color tokens (Light Mode) */
            --color-bg-1: rgba(59, 130, 246, 0.08);
            --color-bg-2: rgba(245, 158, 11, 0.08);
            --color-bg-3: rgba(34, 197, 94, 0.08);
            --color-bg-4: rgba(239, 68, 68, 0.08);
            --color-bg-5: rgba(147, 51, 234, 0.08);
            --color-bg-6: rgba(249, 115, 22, 0.08);
            --color-bg-7: rgba(236, 72, 153, 0.08);
            --color-bg-8: rgba(6, 182, 212, 0.08);

            /* Semantic Color Tokens (Light Mode) */
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-btn-primary-text: var(--color-cream-50);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
            --color-error: var(--color-red-500);
            --color-success: var(--color-teal-500);
            --color-warning: var(--color-orange-500);
            --color-info: var(--color-slate-500);
            --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
            --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

            /* Typography */
            --font-family-base: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --font-family-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            --font-size-xs: 11px;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 14px;
            --font-size-lg: 16px;
            --font-size-xl: 18px;
            --font-size-2xl: 20px;
            --font-size-3xl: 24px;
            --font-size-4xl: 30px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 550;
            --font-weight-bold: 600;
            --line-height-tight: 1.2;
            --line-height-normal: 1.5;
            --letter-spacing-tight: -0.01em;

            /* Spacing */
            --space-0: 0;
            --space-1: 1px;
            --space-2: 2px;
            --space-4: 4px;
            --space-6: 6px;
            --space-8: 8px;
            --space-10: 10px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;

            /* Border Radius */
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            --radius-full: 9999px;

            /* Shadows */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
            --shadow-inset-sm: inset 0 1px 0 rgba(255, 255, 255, 0.15), inset 0 -1px 0 rgba(0, 0, 0, 0.03);

            /* Animation */
            --duration-fast: 150ms;
            --duration-normal: 250ms;
            --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);

            /* RPG Custom Colors */
            --color-xp: #4ade80;
            --color-level: #fbbf24;
            --color-matrix: #00ff00;
            --color-danger: #ef4444;
        }

        /* Dark mode colors */
        @media (prefers-color-scheme: dark) {
            :root {
                --color-gray-400-rgb: 119, 124, 124;
                --color-teal-300-rgb: 50, 184, 198;
                --color-gray-300-rgb: 167, 169, 169;
                --color-gray-200-rgb: 245, 245, 245;
                --color-bg-1: rgba(29, 78, 216, 0.15);
                --color-bg-2: rgba(180, 83, 9, 0.15);
                --color-bg-3: rgba(21, 128, 61, 0.15);
                --color-bg-4: rgba(185, 28, 28, 0.15);
                --color-bg-5: rgba(107, 33, 168, 0.15);
                --color-bg-6: rgba(194, 65, 12, 0.15);
                --color-bg-7: rgba(190, 24, 93, 0.15);
                --color-bg-8: rgba(8, 145, 178, 0.15);
                --color-background: var(--color-charcoal-700);
                --color-surface: var(--color-charcoal-800);
                --color-text: var(--color-gray-200);
                --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
                --color-primary: var(--color-teal-300);
                --color-primary-hover: var(--color-teal-400);
                --color-primary-active: var(--color-teal-800);
                --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
                --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
                --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
                --color-border: rgba(var(--color-gray-400-rgb), 0.3);
                --color-error: var(--color-red-400);
                --color-success: var(--color-teal-300);
                --color-warning: var(--color-orange-400);
                --color-info: var(--color-gray-300);
                --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
                --color-btn-primary-text: var(--color-slate-900);
                --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
                --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
            }
        }

        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: var(--font-size-base);
            font-family: var(--font-family-base);
            line-height: var(--line-height-normal);
            color: var(--color-text);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
        }

        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        /* Layout */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .header {
            background: var(--color-surface);
            border-bottom: 1px solid var(--color-border);
            padding: var(--space-16);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            height: 48px;
            width: auto;
        }

        .progress-bar {
            background: var(--color-secondary);
            border-radius: var(--radius-full);
            height: 8px;
            width: 200px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--color-primary);
            height: 100%;
            border-radius: inherit;
            transition: width var(--duration-normal) var(--ease-standard);
            width: 0%;
        }

        .player-stats {
            display: flex;
            gap: var(--space-16);
            align-items: center;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: var(--space-8);
            font-weight: var(--font-weight-medium);
        }

        .xp-badge {
            background: var(--color-xp);
            color: white;
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
        }

        .level-badge {
            background: var(--color-level);
            color: var(--color-charcoal-700);
            padding: var(--space-4) var(--space-8);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
        }

        .main-content {
            flex: 1;
            margin-top: 80px;
            padding: var(--space-24);
        }

        /* Screens */
        .screen {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn var(--duration-normal) var(--ease-standard);
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cards */
        .card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            margin-bottom: var(--space-24);
            box-shadow: var(--shadow-sm);
        }

        .hero-card {
            background: linear-gradient(135deg, var(--color-bg-1), var(--color-bg-3));
            border: 2px solid var(--color-primary);
            text-align: center;
            padding: var(--space-32);
        }

        /* Typography */
        h1 {
            font-size: var(--font-size-4xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            margin-bottom: var(--space-16);
            line-height: var(--line-height-tight);
        }

        h2 {
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin-bottom: var(--space-16);
        }

        h3 {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
            margin-bottom: var(--space-12);
        }

        p {
            color: var(--color-text);
            margin-bottom: var(--space-16);
            line-height: var(--line-height-normal);
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: var(--font-size-lg);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-8);
            padding: var(--space-12) var(--space-24);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease-standard);
            text-decoration: none;
        }

        .btn:focus-visible {
            outline: 2px solid var(--color-focus-ring);
            outline-offset: 2px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--color-secondary);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: var(--color-secondary-hover);
        }

        .btn-danger {
            background: var(--color-danger);
            color: white;
        }

        .btn-large {
            padding: var(--space-16) var(--space-32);
            font-size: var(--font-size-lg);
            border-radius: var(--radius-md);
        }

        .btn-block {
            width: 100%;
            margin-bottom: var(--space-12);
        }

        /* Character Selection */
        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-20);
            margin: var(--space-24) 0;
        }

        .character-card {
            background: var(--color-surface);
            border: 2px solid transparent;
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            text-align: center;
            cursor: pointer;
            transition: all var(--duration-normal) var(--ease-standard);
        }

        .character-card:hover {
            border-color: var(--color-primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .character-card.selected {
            border-color: var(--color-primary);
            background: var(--color-bg-1);
        }

        .character-avatar {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            background: var(--color-primary);
            margin: 0 auto var(--space-12);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-3xl);
            color: white;
        }

        /* Activity Components */
        .activity-container {
            margin: var(--space-24) 0;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin: var(--space-20) 0;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: var(--radius-lg);
        }

        .quiz-container {
            background: var(--color-bg-2);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            margin: var(--space-20) 0;
        }

        .question {
            margin-bottom: var(--space-20);
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: var(--space-12);
        }

        .option {
            background: var(--color-surface);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: var(--space-12);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .option:hover {
            border-color: var(--color-primary);
        }

        .option.selected {
            border-color: var(--color-primary);
            background: var(--color-bg-1);
        }

        .option.correct {
            border-color: var(--color-success);
            background: var(--color-bg-3);
        }

        .option.incorrect {
            border-color: var(--color-error);
            background: var(--color-bg-4);
        }

        /* Drag &amp; Drop Simulation */
        .drag-drop-container {
            background: var(--color-bg-5);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            margin: var(--space-20) 0;
        }

        .drag-items {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-12);
            margin-bottom: var(--space-20);
        }

        .drag-item {
            background: var(--color-surface);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: var(--space-8) var(--space-12);
            cursor: move;
            user-select: none;
            transition: all var(--duration-fast) var(--ease-standard);
        }

        .drag-item:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .drop-zones {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-16);
        }

        .drop-zone {
            background: var(--color-secondary);
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-base);
            min-height: 100px;
            padding: var(--space-16);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .drop-zone.highlight {
            border-color: var(--color-primary);
            background: var(--color-bg-1);
        }

        /* Interactive Elements */
        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--space-12);
            margin: var(--space-20) 0;
        }

        .timeline {
            position: relative;
            padding: var(--space-20) 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--color-primary);
            transform: translateX(-50%);
        }

        .timeline-item {
            display: flex;
            margin-bottom: var(--space-24);
            position: relative;
        }

        .timeline-item:nth-child(odd) {
            flex-direction: row;
        }

        .timeline-item:nth-child(even) {
            flex-direction: row-reverse;
        }

        .timeline-content {
            flex: 1;
            margin: 0 var(--space-20);
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-16);
        }

        .timeline-marker {
            position: absolute;
            left: 50%;
            top: 20px;
            width: 16px;
            height: 16px;
            background: var(--color-primary);
            border-radius: var(--radius-full);
            transform: translateX(-50%);
            z-index: 1;
        }

        /* Feedback */
        .feedback {
            padding: var(--space-16);
            border-radius: var(--radius-base);
            margin: var(--space-12) 0;
        }

        .feedback.success {
            background: var(--color-bg-3);
            border: 1px solid var(--color-success);
            color: var(--color-success);
        }

        .feedback.error {
            background: var(--color-bg-4);
            border: 1px solid var(--color-error);
            color: var(--color-error);
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: var(--space-32);
            padding-top: var(--space-20);
            border-top: 1px solid var(--color-border);
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: var(--space-12);
            }

            .main-content {
                margin-top: 120px;
                padding: var(--space-16);
            }

            .character-grid {
                grid-template-columns: 1fr;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-item {
                flex-direction: row !important;
                padding-left: var(--space-32);
            }

            .timeline-marker {
                left: 20px;
            }

            .timeline-content {
                margin-left: var(--space-20);
                margin-right: 0;
            }
        }

        /* Gamification Elements */
        .badge-container {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-8);
            margin: var(--space-16) 0;
        }

        .badge {
            background: var(--color-warning);
            color: var(--color-charcoal-700);
            padding: var(--space-6) var(--space-12);
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            display: flex;
            align-items: center;
            gap: var(--space-6);
        }

        .badge.locked {
            background: var(--color-secondary);
            color: var(--color-text-secondary);
            opacity: 0.6;
        }

        .notification {
            position: fixed;
            top: 100px;
            right: var(--space-20);
            background: var(--color-success);
            color: white;
            padding: var(--space-12) var(--space-16);
            border-radius: var(--radius-base);
            box-shadow: var(--shadow-lg);
            transform: translateX(100%);
            transition: transform var(--duration-normal) var(--ease-standard);
            z-index: 200;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Credits */
        .credits {
            background: var(--color-bg-6);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            text-align: center;
            margin-top: var(--space-32);
        }

        .credits a {
            color: var(--color-primary);
            text-decoration: none;
            font-weight: var(--font-weight-medium);
        }

        .credits a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/0394e881-81e2-4d15-ad67-06cc7b88cef7.png" alt="ChemMatrix RPG Logo" class="logo">
                <div class="progress-bar" aria-label="Progresso da aventura">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="player-stats">
                    <div class="stat">
                        <span class="xp-badge" id="xpDisplay">0 XP</span>
                    </div>
                    <div class="stat">
                        <span class="level-badge" id="levelDisplay">N√≠vel 1</span>
                    </div>
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- Screen 1: Welcome -->
            <div class="screen active" id="screen-welcome">
                <div class="hero-card">
                    <h1>üß™ ChemMatrix RPG üß™</h1>
                    <p class="subtitle">Uma aventura cient√≠fica interativa pelo mundo da Qu√≠mica</p>
                    <p>Bem-vindo(a), jovem cientista! Voc√™ est√° prestes a embarcar em uma jornada √©pica atrav√©s das mol√©culas, √°tomos e rea√ß√µes que moldam nosso mundo.</p>
                    <p>Nesta aventura baseada na estrutura Matrix, voc√™ investigar√° <strong>anomalias energ√©ticas globais</strong> que s√≥ podem ser compreendidas atrav√©s do conhecimento sobre <strong>Petr√≥leo, Pol√≠meros e Radioatividade</strong>.</p>
                    <button class="btn btn-primary btn-large" onclick="startAdventure()" aria-label="Come√ßar a aventura">üöÄ Come√ßar Aventura</button>
                </div>
                
                <div class="card">
                    <h3>üéØ Compet√™ncias BNCC Desenvolvidas</h3>
                    <ul>
                        <li><strong>CG 5:</strong> Compreender, utilizar e criar tecnologias digitais</li>
                        <li><strong>CG 7:</strong> Argumentar com base em fatos, dados e informa√ß√µes confi√°veis</li>
                        <li><strong>EM13CNT307:</strong> Analisar as propriedades dos materiais para avaliar a adequa√ß√£o</li>
                        <li><strong>EM13CNT301:</strong> Construir quest√µes, elaborar hip√≥teses, previs√µes e estrat√©gias</li>
                        <li><strong>EM13CNT101:</strong> Analisar e representar transforma√ß√µes e conserva√ß√µes</li>
                        <li><strong>EM13CNT206:</strong> Discutir a import√¢ncia da preserva√ß√£o e conserva√ß√£o da biodiversidade</li>
                    </ul>
                </div>
            </div>

            <!-- Screen 2: Character Selection -->
            <div class="screen" id="screen-character">
                <div class="card">
                    <h2>üß¨ Ato I - A P√≠lula Vermelha</h2>
                    <p>Voc√™ acorda em um laborat√≥rio futurista. Luzes piscam ao seu redor e voc√™ percebe que algo extraordin√°rio est√° acontecendo. Um cientista misterioso se aproxima...</p>
                    <p><em>"Escolha sua identidade, jovem explorador. Cada cientista tem habilidades √∫nicas que o ajudar√£o nesta jornada."</em></p>
                    
                    <h3>Escolha seu Avatar Cient√≠fico:</h3>
                    <div class="character-grid">
                        <div class="character-card" onclick="selectCharacter('curie')">
                            <div class="character-avatar">‚öóÔ∏è</div>
                            <h4>Marie Curie Jr.</h4>
                            <p>Especialista em Radioatividade</p>
                            <p><small>Habilidade: Detecta radia√ß√µes com precis√£o +20%</small></p>
                        </div>
                        <div class="character-card" onclick="selectCharacter('carothers')">
                            <div class="character-avatar">üß™</div>
                            <h4>Wallace Carothers Jr.</h4>
                            <p>Mestre dos Pol√≠meros</p>
                            <p><small>Habilidade: Compreende estruturas moleculares +20%</small></p>
                        </div>
                        <div class="character-card" onclick="selectCharacter('petroleum')">
                            <div class="character-avatar">üõ¢Ô∏è</div>
                            <h4>Petro Explorer</h4>
                            <p>Especialista em Petr√≥leo</p>
                            <p><small>Habilidade: Identifica compostos org√¢nicos +20%</small></p>
                        </div>
                        <div class="character-card" onclick="selectCharacter('matrix')">
                            <div class="character-avatar">ü§ñ</div>
                            <h4>Neo Cient√≠fico</h4>
                            <p>Hacker Qu√≠mico</p>
                            <p><small>Habilidade: Quebra c√≥digos moleculares +20%</small></p>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('welcome')" aria-label="Voltar para tela inicial">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startMission()" id="startMissionBtn" disabled aria-label="Iniciar miss√£o">Iniciar Miss√£o ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 3: Act II - Petroleum Training -->
            <div class="screen" id="screen-petroleum">
                <div class="card">
                    <h2>üõ¢Ô∏è Ato II - Treinamento em Nabucodonosor</h2>
                    <h3>Laborat√≥rio de Petr√≥leo &amp; Destila√ß√£o</h3>
                    <p>Voc√™ foi transportado para o centro de treinamento da nave Nabucodonosor. Aqui, voc√™ aprender√° sobre os <strong>fundamentos do petr√≥leo</strong> antes de enfrentar os desafios da Matrix.</p>
                    
                    <div class="activity-container">
                        <h4>üì∫ V√≠deo Educativo - Destila√ß√£o Fracionada</h4>
                        <p>Assista ao Prof. Paulo Valim explicar o processo industrial da destila√ß√£o fracionada do petr√≥leo:</p>
                        <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/Kcs2jK1tk78" title="Destila√ß√£o Fracionada do Petr√≥leo" allowfullscreen></iframe>
                        </div>
                        <button class="btn btn-primary" onclick="completeVideo('petroleum')" id="petroleumVideoBtn">‚úÖ V√≠deo Assistido</button>
                    </div>

                    <div class="drag-drop-container">
                        <h4>üéØ Atividade H5P: Drag &amp; Drop - Produtos do Petr√≥leo</h4>
                        <p>Arraste cada produto para sua respectiva temperatura de ebuli√ß√£o:</p>
                        
                        <div class="drag-items" id="petroleumItems">
                            <div class="drag-item" draggable="true" data-product="gasolina">Gasolina</div>
                            <div class="drag-item" draggable="true" data-product="querosene">Querosene</div>
                            <div class="drag-item" draggable="true" data-product="diesel">Diesel</div>
                            <div class="drag-item" draggable="true" data-product="asfalto">Asfalto</div>
                        </div>
                        
                        <div class="drop-zones">
                            <div class="drop-zone" data-temp="30-200">30-200¬∞C</div>
                            <div class="drop-zone" data-temp="150-300">150-300¬∞C</div>
                            <div class="drop-zone" data-temp="200-350">200-350¬∞C</div>
                            <div class="drop-zone" data-temp="350+">Acima de 350¬∞C</div>
                        </div>
                        
                        <div id="petroleumFeedback" class="feedback" style="display: none;"></div>
                        <button class="btn btn-primary" onclick="checkPetroleumDragDrop()" id="checkPetroleumBtn" style="display: none;">Verificar Respostas</button>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('character')" aria-label="Voltar para sele√ß√£o de personagem">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="goToScreen('polymers')" id="toPolymersBtn" disabled aria-label="Ir para pol√≠meros">Pr√≥ximo: Pol√≠meros ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 4: Polymers Training -->
            <div class="screen" id="screen-polymers">
                <div class="card">
                    <h2>üß™ Laborat√≥rio de Pol√≠meros</h2>
                    <p>Agora voc√™ precisa dominar o conhecimento sobre <strong>pol√≠meros</strong>. Estas macromol√©culas s√£o essenciais para compreender os materiais do futuro!</p>
                    
                    <div class="activity-container">
                        <h4>üì∫ V√≠deo Educativo - Pol√≠meros de Adi√ß√£o e Condensa√ß√£o</h4>
                        <p>Descomplica o mundo dos pol√≠meros com este v√≠deo animado:</p>
                        <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/J_f62aYyLgE" title="Pol√≠meros de Adi√ß√£o e Condensa√ß√£o" allowfullscreen></iframe>
                        </div>
                        <button class="btn btn-primary" onclick="completeVideo('polymers')" id="polymersVideoBtn">‚úÖ V√≠deo Assistido</button>
                    </div>

                    <div class="quiz-container">
                        <h4>üéØ Interactive Book Simulation - Tipos de Polimeriza√ß√£o</h4>
                        <div class="question">
                            <h5>Quest√£o 1: Qual √© a principal caracter√≠stica dos homopol√≠meros?</h5>
                            <div class="options" id="polymerQ1">
                                <div class="option" onclick="selectOption(this, false)">S√£o formados por diferentes tipos de mon√¥meros</div>
                                <div class="option" onclick="selectOption(this, true)">S√£o formados por um √∫nico tipo de mon√¥mero</div>
                                <div class="option" onclick="selectOption(this, false)">Sempre eliminam mol√©culas pequenas na forma√ß√£o</div>
                                <div class="option" onclick="selectOption(this, false)">N√£o podem formar cadeias longas</div>
                            </div>
                        </div>
                        
                        <div class="question">
                            <h5>Quest√£o 2: Qual processo caracteriza a polimeriza√ß√£o por condensa√ß√£o?</h5>
                            <div class="options" id="polymerQ2">
                                <div class="option" onclick="selectOption(this, false)">Apenas adi√ß√£o de mon√¥meros</div>
                                <div class="option" onclick="selectOption(this, true)">Elimina√ß√£o de mol√©culas pequenas (H‚ÇÇO, HCl)</div>
                                <div class="option" onclick="selectOption(this, false)">Quebra de liga√ß√µes duplas</div>
                                <div class="option" onclick="selectOption(this, false)">Forma√ß√£o apenas de homopol√≠meros</div>
                            </div>
                        </div>
                        
                        <div id="polymerFeedback" class="feedback" style="display: none;"></div>
                    </div>
                    
                    <div class="choice-buttons">
                        <h4>üéÆ Branching Scenario - Aplicacao Industrial</h4>
                        <p>Voce esta em uma fabrica e precisa escolher o polimero adequado para cada aplicacao:</p>
                        <button class="btn btn-secondary btn-block" onclick="makeChoice('plastic-bags')">üõçÔ∏è Sacolas plasticas - Polietileno</button>
                        <button class="btn btn-secondary btn-block" onclick="makeChoice('bottles')">üç∂ Garrafas - PET</button>
                        <button class="btn btn-secondary btn-block" onclick="makeChoice('pipes')">üö∞ Tubulacoes - PVC</button>
                        <div id="choiceFeedback" class="feedback" style="display: none;"></div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('petroleum')" aria-label="Voltar para petr√≥leo">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="goToScreen('radioactivity')" id="toRadioactivityBtn" disabled aria-label="Ir para radioatividade">Pr√≥ximo: Radioatividade ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 5: Act III - Radioactivity Mission -->
            <div class="screen" id="screen-radioactivity">
                <div class="card">
                    <h2>‚ò¢Ô∏è Ato III - Miss√µes na Matrix</h2>
                    <h3>Centro de Controle Nuclear</h3>
                    <p>Voc√™ foi enviado para investigar anomalias radioativas na Matrix. O conhecimento sobre <strong>radioatividade</strong> ser√° crucial para sua sobreviv√™ncia!</p>
                    
                    <div class="activity-container">
                        <h4>üì∫ V√≠deo Introdut√≥rio - O que √© Radia√ß√£o?</h4>
                        <p>Entenda os fundamentos da radia√ß√£o com este v√≠deo do Pontoci√™ncia:</p>
                        <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/ysykej_3a3o" title="O que √© a radia√ß√£o?" allowfullscreen></iframe>
                        </div>
                        <button class="btn btn-primary" onclick="completeVideo('radiation')" id="radiationVideoBtn">‚úÖ V√≠deo Assistido</button>
                    </div>

                    <div class="drag-drop-container">
                        <h4>üéØ Interactive Structure - Tipos de Radia√ß√£o</h4>
                        <p>Organize os tipos de radia√ß√£o por seu poder de penetra√ß√£o (do menor para o maior):</p>
                        
                        <div class="drag-items" id="radiationItems">
                            <div class="drag-item" draggable="true" data-type="alpha">Radia√ß√£o Alfa (Œ±) - 2p + 2n</div>
                            <div class="drag-item" draggable="true" data-type="beta">Radia√ß√£o Beta (Œ≤) - el√©trons</div>
                            <div class="drag-item" draggable="true" data-type="gamma">Radia√ß√£o Gama (Œ≥) - eletromagn√©tica</div>
                        </div>
                        
                        <div class="drop-zones">
                            <div class="drop-zone" data-penetration="low">Menor Penetra√ß√£o<br><small>Barrada por papel</small></div>
                            <div class="drop-zone" data-penetration="medium">Penetra√ß√£o M√©dia<br><small>Barrada por alum√≠nio</small></div>
                            <div class="drop-zone" data-penetration="high">Maior Penetra√ß√£o<br><small>Barrada por chumbo grosso</small></div>
                        </div>
                        
                        <div id="radiationFeedback" class="feedback" style="display: none;"></div>
                        <button class="btn btn-primary" onclick="checkRadiationDragDrop()" id="checkRadiationBtn" style="display: none;">Verificar Respostas</button>
                    </div>

                    <div class="activity-container">
                        <h4>üì∫ V√≠deo Educativo - Meia-vida</h4>
                        <p>Compreenda o conceito de meia-vida radioativa:</p>
                        <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/iA41-d5l1pE" title="Meia-vida" allowfullscreen></iframe>
                        </div>
                        <button class="btn btn-primary" onclick="completeVideo('halflife')" id="halflifeVideoBtn">‚úÖ V√≠deo Assistido</button>
                    </div>

                    <div class="quiz-container">
                        <h4>üî¢ Arithmetic Quiz - C√°lculos de Meia-vida</h4>
                        <div class="question">
                            <h5>Se um elemento radioativo tem meia-vida de 10 anos e voc√™ come√ßou com 100g, quanto restar√° ap√≥s 30 anos?</h5>
                            <div class="options" id="halflifeQ">
                                <div class="option" onclick="selectOption(this, false)">25g</div>
                                <div class="option" onclick="selectOption(this, true)">12,5g</div>
                                <div class="option" onclick="selectOption(this, false)">6,25g</div>
                                <div class="option" onclick="selectOption(this, false)">3,125g</div>
                            </div>
                            <div class="feedback" style="display: none;">üí° <strong>Explica√ß√£o:</strong> Em 30 anos (3 meias-vidas): 100g ‚Üí 50g ‚Üí 25g ‚Üí 12,5g</div>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('polymers')" aria-label="Voltar para pol√≠meros">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="goToScreen('nuclear')" id="toNuclearBtn" disabled aria-label="Ir para rea√ß√µes nucleares">Pr√≥ximo: Rea√ß√µes Nucleares ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 6: Nuclear Reactions -->
            <div class="screen" id="screen-nuclear">
                <div class="card">
                    <h2>‚öõÔ∏è Rea√ß√µes Nucleares - Fus√£o e Fiss√£o</h2>
                    <p>O conhecimento final necess√°rio para sua miss√£o: compreender as <strong>rea√ß√µes nucleares</strong> que alimentam tanto o Sol quanto as usinas nucleares.</p>
                    
                    <div class="activity-container">
                        <h4>üì∫ V√≠deo Educativo - Fiss√£o e Fus√£o Nuclear</h4>
                        <p>Aprenda sobre os dois principais tipos de rea√ß√µes nucleares:</p>
                        <div class="video-container">
                            <iframe src="https://www.youtube.com/embed/vcZDFAP2Y2s" title="Fiss√£o e Fus√£o Nuclear" allowfullscreen></iframe>
                        </div>
                        <button class="btn btn-primary" onclick="completeVideo('nuclear')" id="nuclearVideoBtn">‚úÖ V√≠deo Assistido</button>
                    </div>

                    <div class="quiz-container">
                        <h4>üéØ Dialog Cards Simulation - Decis√µes de Seguran√ßa Nuclear</h4>
                        <div class="question">
                            <h5>‚ö†Ô∏è ALERTA: Detectada anomalia no reator! Qual sua decis√£o?</h5>
                            <div class="choice-buttons">
                                <button class="btn btn-danger btn-block" onclick="nuclearChoice('emergency', 'Correto! Em emerg√™ncias nucleares, seguran√ßa √© prioridade absoluta.')">üö® Ativar protocolo de emerg√™ncia</button>
                                <button class="btn btn-secondary btn-block" onclick="nuclearChoice('monitor', 'Arriscado! Monitorar pode ser insuficiente em situa√ß√µes cr√≠ticas.')">üìä Apenas monitorar os n√≠veis</button>
                                <button class="btn btn-secondary btn-block" onclick="nuclearChoice('increase', 'PERIGOSO! Nunca aumente pot√™ncia durante anomalias!')">‚ö° Aumentar pot√™ncia para normalizar</button>
                            </div>
                            <div id="nuclearChoiceFeedback" class="feedback" style="display: none;"></div>
                        </div>
                        
                        <div class="question">
                            <h5>Qual processo libera mais energia por nucleon?</h5>
                            <div class="options" id="nuclearQ">
                                <div class="option" onclick="selectOption(this, false)">Fiss√£o de Ur√¢nio-235</div>
                                <div class="option" onclick="selectOption(this, true)">Fus√£o de Hidrog√™nio em H√©lio</div>
                                <div class="option" onclick="selectOption(this, false)">Decaimento radioativo</div>
                                <div class="option" onclick="selectOption(this, false)">Todas liberam a mesma energia</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('radioactivity')" aria-label="Voltar para radioatividade">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="goToScreen('final-battle')" id="toFinalBtn" disabled aria-label="Ir para batalha final">Batalha Final ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 7: Act IV - Final Battle -->
            <div class="screen" id="screen-final-battle">
                <div class="card">
                    <h2>‚öîÔ∏è Ato IV - A Batalha Final</h2>
                    <h3>Centro de Controle Global</h3>
                    <p>Chegou o momento decisivo! Voc√™ descobriu que as anomalias energ√©ticas s√£o causadas por um v√≠rus qu√≠mico que est√° corrompendo as estruturas moleculares do planeta.</p>
                    <p>Use todo seu conhecimento para tomar as decis√µes certas e salvar o mundo!</p>
                    
                    <div class="quiz-container">
                        <h4>üéÆ Course Presentation - Desafio Integrativo</h4>
                        
                        <div class="question">
                            <h5>üõ¢Ô∏è SITUA√á√ÉO 1: O v√≠rus est√° atacando uma refinaria de petr√≥leo. Qual produto voc√™ prioriza proteger?</h5>
                            <div class="choice-buttons">
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('gasoline', 20, 'Boa escolha! Gasolina √© essencial para transporte de emerg√™ncia.')">‚õΩ Gasolina (30-200¬∞C)</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('diesel', 30, 'Excelente! Diesel √© crucial para geradores e ve√≠culos pesados.')">üöõ Diesel (200-350¬∞C)</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('asphalt', 10, '√ötil para infraestrutura, mas n√£o prioridade em emerg√™ncia.')">üõ£Ô∏è Asfalto (>350¬∞C)</button>
                            </div>
                        </div>
                        
                        <div class="question">
                            <h5>üß™ SITUA√á√ÉO 2: Voc√™ precisa criar um pol√≠mero resistente ao v√≠rus. Qual escolhe?</h5>
                            <div class="choice-buttons">
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('pet', 25, '√ìtimo! PET por condensa√ß√£o √© resistente quimicamente.')">üç∂ PET (pol√≠mero de condensa√ß√£o)</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('polyethylene', 20, 'Bom! Polietileno √© vers√°til mas menos resistente quimicamente.')">üõçÔ∏è Polietileno (pol√≠mero de adi√ß√£o)</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('copolymer', 35, 'EXCELENTE! Copol√≠meros combinam propriedades de diferentes mon√¥meros!')">‚≠ê Copol√≠mero especial</button>
                            </div>
                        </div>
                        
                        <div class="question">
                            <h5>‚ò¢Ô∏è SITUA√á√ÉO 3: O v√≠rus emite radia√ß√£o. Qual prote√ß√£o voc√™ usa?</h5>
                            <div class="choice-buttons">
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('paper', 5, 'Insuficiente! Papel s√≥ protege contra radia√ß√£o alfa.')">üìÑ Barreira de papel</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('aluminum', 15, 'Parcial! Alum√≠nio protege contra alfa e beta.')">‚ö° Barreira de alum√≠nio</button>
                                <button class="btn btn-secondary btn-block" onclick="finalChoice('lead', 40, 'PERFEITO! Chumbo protege contra todos os tipos de radia√ß√£o!')">üõ°Ô∏è Barreira de chumbo</button>
                            </div>
                        </div>
                        
                        <div id="finalScore" class="feedback" style="display: none;"></div>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn btn-secondary" onclick="goToScreen('nuclear')" aria-label="Voltar para rea√ß√µes nucleares">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="showEnding()" id="showEndingBtn" disabled aria-label="Ver final da hist√≥ria">Ver Final ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Screen 8: Epilogue -->
            <div class="screen" id="screen-epilogue">
                <div class="card">
                    <h2>üèÜ Ep√≠logo - O Retorno a Zion</h2>
                    <div id="endingContent"></div>
                    
                    <div class="activity-container">
                        <h4>ü§î Momento de Metacogni√ß√£o</h4>
                        <div class="quiz-container">
                            <h5>Reflita sobre sua jornada:</h5>
                            <div class="question">
                                <label for="learned">O que voc√™ aprendeu de mais importante sobre Qu√≠mica hoje?</label>
                                <textarea id="learned" class="form-control" rows="3" placeholder="Descreva suas principais descobertas..."></textarea>
                            </div>
                            <div class="question">
                                <label for="difficult">Qual foi o conceito mais desafiador?</label>
                                <textarea id="difficult" class="form-control" rows="3" placeholder="Que dificuldades voc√™ enfrentou?"></textarea>
                            </div>
                            <div class="question">
                                <label for="strategies">Que estrat√©gias voc√™ usaria para superar essas dificuldades?</label>
                                <textarea id="strategies" class="form-control" rows="3" placeholder="Como voc√™ pode melhorar seu aprendizado?"></textarea>
                            </div>
                            <button class="btn btn-primary" onclick="saveReflection()">üíæ Salvar Reflex√£o</button>
                        </div>
                    </div>

                    <div class="timeline">
                        <h4>üìö Timeline das Descobertas Cient√≠ficas</h4>
                        
                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <h5>1859 - Primeira Perfura√ß√£o de Petr√≥leo</h5>
                                <p>Edwin Drake perfura o primeiro po√ßo de petr√≥leo comercial na Pensilv√¢nia, iniciando a era do petr√≥leo.</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <h5>1896 - Descoberta da Radioatividade</h5>
                                <p>Henri Becquerel descobre a radioatividade natural, abrindo caminho para Marie Curie.</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <h5>1930s - Era dos Pol√≠meros</h5>
                                <p>Wallace Carothers desenvolve o nylon, revolucionando a ind√∫stria de materiais sint√©ticos.</p>
                            </div>
                        </div>
                        
                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <h5>1942 - Primeira Rea√ß√£o Nuclear Controlada</h5>
                                <p>Enrico Fermi achieve a primeira rea√ß√£o nuclear controlada em Chicago.</p>
                            </div>
                        </div>
                    </div>

                    <div class="badge-container">
                        <h4>üèÖ Suas Conquistas</h4>
                        <div id="finalBadges"></div>
                    </div>
                    
                    <div class="choice-buttons">
                        <button class="btn btn-primary btn-block" onclick="restartAdventure()">üîÑ Jogar Novamente</button>
                        <button class="btn btn-secondary btn-block" onclick="exportResults()">üìä Exportar Resultados</button>
                    </div>
                </div>
                
                <!-- Credits -->
                <div class="credits">
                    <h3>üë©‚Äçüî¨ Cr√©ditos</h3>
                    <p><strong>Prof.¬™ P√¢mella A. Balca√ßar</strong></p>
                    <p><a href="http://lattes.cnpq.br/1206643836491711" target="_blank" rel="noopener noreferrer" aria-label="Acessar curr√≠culo Lattes da professora P√¢mella">üìã Curr√≠culo Lattes</a> | <a href="https://twitter.com/pamellabiotec" target="_blank" rel="noopener noreferrer" aria-label="Seguir @pamellabiotec no Twitter">üê¶ @pamellabiotec</a></p>
                    <p>üÑØ Licen√ßa <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer" aria-label="Informa√ß√µes sobre licen√ßa Creative Commons">CC BY-NC-SA 4.0</a></p>
                    <p><small>Produto educacional desenvolvido para forma√ß√£o cient√≠fica de estudantes do 3¬∫ ano do Ensino M√©dio, alinhado √†s compet√™ncias da BNCC.</small></p>
                </div>
            </div>
        </main>

        <!-- Notification System -->
        <div class="notification" id="notification"></div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentScreen: 'welcome',
            character: null,
            xp: 0,
            level: 1,
            progress: 0,
            completedActivities: {
                petroleumVideo: false,
                petroleumDragDrop: false,
                polymersVideo: false,
                polymersQuiz: false,
                polymersChoice: false,
                radiationVideo: false,
                radiationDragDrop: false,
                halflifeVideo: false,
                halflifeQuiz: false,
                nuclearVideo: false,
                nuclearQuiz: false,
                finalBattle: false
            },
            badges: [],
            finalScore: 0,
            answers: {
                petroleum: {},
                polymers: {},
                radiation: {},
                nuclear: {},
                final: {}
            }
        };

        // Drag and Drop State
        let dragDropState = {
            petroleum: {
                correct: {
                    'gasolina': '30-200',
                    'querosene': '150-300', 
                    'diesel': '200-350',
                    'asfalto': '350+'
                },
                userAnswers: {}
            },
            radiation: {
                correct: {
                    'alpha': 'low',
                    'beta': 'medium',
                    'gamma': 'high'
                },
                userAnswers: {}
            }
        };

        // Utility Functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification show ${type}`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function addXP(amount) {
            gameState.xp += amount;
            const newLevel = Math.floor(gameState.xp / 100) + 1;
            
            if (newLevel > gameState.level) {
                gameState.level = newLevel;
                showNotification(`üéâ Level Up! Voc√™ atingiu o n√≠vel ${newLevel}!`);
            }
            
            updateUI();
        }

        function updateProgress() {
            const totalActivities = Object.keys(gameState.completedActivities).length;
            const completedCount = Object.values(gameState.completedActivities).filter(Boolean).length;
            gameState.progress = Math.round((completedCount / totalActivities) * 100);
            updateUI();
        }

        function updateUI() {
            document.getElementById('xpDisplay').textContent = `${gameState.xp} XP`;
            document.getElementById('levelDisplay').textContent = `N√≠vel ${gameState.level}`;
            document.getElementById('progressFill').style.width = `${gameState.progress}%`;
        }

        function awardBadge(badgeId, badgeName, description) {
            if (!gameState.badges.includes(badgeId)) {
                gameState.badges.push(badgeId);
                showNotification(`üèÖ Nova conquista: ${badgeName}!`);
            }
        }

        // Screen Navigation
        function goToScreen(screenId) {
            // Hide current screen
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show target screen
            document.getElementById(`screen-${screenId}`).classList.add('active');
            gameState.currentScreen = screenId;
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Adventure Flow
        function startAdventure() {
            goToScreen('character');
            addXP(10);
        }

        function selectCharacter(characterId) {
            // Remove previous selections
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Mark selected character
            event.target.closest('.character-card').classList.add('selected');
            gameState.character = characterId;
            
            // Enable start mission button
            document.getElementById('startMissionBtn').disabled = false;
            
            addXP(15);
        }

        function startMission() {
            if (!gameState.character) {
                showNotification('Selecione um personagem primeiro!', 'error');
                return;
            }
            
            goToScreen('petroleum');
            awardBadge('explorer', 'Explorador Qu√≠mico', 'Iniciou a jornada cient√≠fica');
            
            // Setup drag and drop for petroleum
            setupPetroleumDragDrop();
        }

        // Video Completion
        function completeVideo(videoType) {
            gameState.completedActivities[`${videoType}Video`] = true;
            addXP(25);
            updateProgress();
            
            // Enable next activities
            switch(videoType) {
                case 'petroleum':
                    showNotification('üé¨ V√≠deo sobre petr√≥leo conclu√≠do!');
                    break;
                case 'polymers':
                    showNotification('üé¨ V√≠deo sobre pol√≠meros conclu√≠do!');
                    break;
                case 'radiation':
                    showNotification('üé¨ V√≠deo sobre radia√ß√£o conclu√≠do!');
                    break;
                case 'halflife':
                    showNotification('üé¨ V√≠deo sobre meia-vida conclu√≠do!');
                    break;
                case 'nuclear':
                    showNotification('üé¨ V√≠deo sobre rea√ß√µes nucleares conclu√≠do!');
                    break;
            }
        }

        // Petroleum Drag & Drop
        function setupPetroleumDragDrop() {
            const items = document.querySelectorAll('#petroleumItems .drag-item');
            const zones = document.querySelectorAll('#screen-petroleum .drop-zone');
            
            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.product);
                });
            });
            
            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('highlight');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('highlight');
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('highlight');
                    
                    const product = e.dataTransfer.getData('text/plain');
                    const temp = zone.dataset.temp;
                    
                    // Remove item from original location
                    const draggedItem = document.querySelector(`[data-product="${product}"]`);
                    
                    // Add to drop zone
                    zone.innerHTML = `<strong>${draggedItem.textContent}</strong><br><small>${temp}</small>`;
                    draggedItem.style.display = 'none';
                    
                    // Store answer
                    dragDropState.petroleum.userAnswers[product] = temp;
                    
                    // Check if all items are placed
                    if (Object.keys(dragDropState.petroleum.userAnswers).length === 4) {
                        document.getElementById('checkPetroleumBtn').style.display = 'block';
                    }
                });
            });
        }

        function checkPetroleumDragDrop() {
            const correct = dragDropState.petroleum.correct;
            const userAnswers = dragDropState.petroleum.userAnswers;
            let score = 0;
            
            for (let product in correct) {
                if (userAnswers[product] === correct[product]) {
                    score += 25;
                }
            }
            
            const feedback = document.getElementById('petroleumFeedback');
            feedback.style.display = 'block';
            
            if (score === 100) {
                feedback.className = 'feedback success';
                feedback.textContent = 'üéâ Perfeito! Voc√™ dominou a destila√ß√£o fracionada do petr√≥leo!';
                awardBadge('petroleum', 'Mestre do Petr√≥leo', 'Dominou a destila√ß√£o fracionada');
                addXP(50);
            } else if (score >= 75) {
                feedback.className = 'feedback success';
                feedback.textContent = 'üëè Muito bem! Voc√™ entende bem o processo de destila√ß√£o.';
                addXP(35);
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = 'ü§î Que tal revisar o v√≠deo? Lembre-se: temperatura de ebuli√ß√£o determina a separa√ß√£o!';
                addXP(15);
            }
            
            gameState.completedActivities.petroleumDragDrop = true;
            document.getElementById('toPolymersBtn').disabled = false;
            updateProgress();
        }

        // Polymers Quiz
        function selectOption(element, isCorrect) {
            // Clear previous selections in this question
            const parent = element.parentElement;
            parent.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selected option
            element.classList.add('selected');
            
            // Show feedback after a delay
            setTimeout(() => {
                element.classList.add(isCorrect ? 'correct' : 'incorrect');
                
                if (isCorrect) {
                    addXP(20);
                }
                
                // Check if all polymer questions are answered
                checkPolymersCompletion();
            }, 500);
        }

        function checkPolymersCompletion() {
            const correctAnswers = document.querySelectorAll('#screen-polymers .option.correct').length;
            
            if (correctAnswers >= 2) {
                gameState.completedActivities.polymersQuiz = true;
                updateProgress();
                
                const feedback = document.getElementById('polymerFeedback');
                feedback.style.display = 'block';
                feedback.className = 'feedback success';
                feedback.textContent = 'üß™ Excelente! Voc√™ compreende bem os tipos de pol√≠meros!';
                
                awardBadge('polymers', 'Mestre dos Pol√≠meros', 'Dominou a polimeriza√ß√£o');
            }
        }

        // Choice System
        function makeChoice(choiceId) {
            const feedbackElement = document.getElementById('choiceFeedback');
            feedbackElement.style.display = 'block';
            feedbackElement.className = 'feedback success';
            
            let feedback = '';
            switch(choiceId) {
                case 'plastic-bags':
                    feedback = 'Correto! Polietileno e ideal para sacolas plasticas por sua flexibilidade e resistencia.';
                    break;
                case 'bottles':
                    feedback = 'Correto! PET e amplamente usado em garrafas por ser transparente e resistente.';
                    break;
                case 'pipes':
                    feedback = 'Correto! PVC e ideal para tubulacoes por sua resistencia quimica e durabilidade.';
                    break;
            }
            
            feedbackElement.textContent = feedback;
            
            gameState.completedActivities.polymersChoice = true;
            document.getElementById('toRadioactivityBtn').disabled = false;
            addXP(30);
            updateProgress();
        }

        // Radiation Drag & Drop
        function setupRadiationDragDrop() {
            const items = document.querySelectorAll('#radiationItems .drag-item');
            const zones = document.querySelectorAll('#screen-radioactivity .drop-zone');
            
            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', e.target.dataset.type);
                });
            });
            
            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('highlight');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('highlight');
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('highlight');
                    
                    const radiationType = e.dataTransfer.getData('text/plain');
                    const penetration = zone.dataset.penetration;
                    
                    // Remove item from original location
                    const draggedItem = document.querySelector(`[data-type="${radiationType}"]`);
                    
                    // Add to drop zone
                    const originalContent = zone.innerHTML;
                    zone.innerHTML = originalContent + `<br><strong>${draggedItem.textContent}</strong>`;
                    draggedItem.style.display = 'none';
                    
                    // Store answer
                    dragDropState.radiation.userAnswers[radiationType] = penetration;
                    
                    // Check if all items are placed
                    if (Object.keys(dragDropState.radiation.userAnswers).length === 3) {
                        document.getElementById('checkRadiationBtn').style.display = 'block';
                    }
                });
            });
        }

        function checkRadiationDragDrop() {
            const correct = dragDropState.radiation.correct;
            const userAnswers = dragDropState.radiation.userAnswers;
            let score = 0;
            
            for (let type in correct) {
                if (userAnswers[type] === correct[type]) {
                    score += 33;
                }
            }
            
            const feedback = document.getElementById('radiationFeedback');
            feedback.style.display = 'block';
            
            if (score >= 99) {
                feedback.className = 'feedback success';
                feedback.textContent = '‚ò¢Ô∏è Perfeito! Voc√™ dominou os tipos de radia√ß√£o e seus poderes de penetra√ß√£o!';
                awardBadge('radiation', 'Guardi√£o Nuclear', 'Dominou a radioatividade');
                addXP(50);
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = 'ü§î Lembre-se: Alfa < Beta < Gama em poder de penetra√ß√£o!';
                addXP(25);
            }
            
            gameState.completedActivities.radiationDragDrop = true;
            document.getElementById('toNuclearBtn').disabled = false;
            updateProgress();
        }

        // Nuclear Decisions
        function nuclearChoice(choiceId, feedback) {
            const feedbackElement = document.getElementById('nuclearChoiceFeedback');
            feedbackElement.style.display = 'block';
            
            if (choiceId === 'emergency') {
                feedbackElement.className = 'feedback success';
                addXP(40);
            } else {
                feedbackElement.className = 'feedback error';
                addXP(10);
            }
            
            feedbackElement.textContent = feedback;
            
            gameState.completedActivities.nuclearQuiz = true;
            document.getElementById('toFinalBtn').disabled = false;
            updateProgress();
        }

        // Final Battle
        function finalChoice(choiceId, points, feedback) {
            gameState.finalScore += points;
            
            // Disable used button and show feedback
            event.target.disabled = true;
            event.target.style.opacity = '0.6';
            
            showNotification(`+${points} pontos: ${feedback}`);
            addXP(points);
            
            // Check if all choices made (3 situations)
            const disabledButtons = document.querySelectorAll('#screen-final-battle .btn:disabled').length;
            if (disabledButtons >= 3) {
                gameState.completedActivities.finalBattle = true;
                updateProgress();
                
                const scoreElement = document.getElementById('finalScore');
                scoreElement.style.display = 'block';
                
                if (gameState.finalScore >= 80) {
                    scoreElement.className = 'feedback success';
                    scoreElement.textContent = `üèÜ EXCELENTE! Pontua√ß√£o final: ${gameState.finalScore}/100. Voc√™ salvou o mundo!`;
                    awardBadge('hero', 'Her√≥i Cient√≠fico', 'Salvou o mundo com conhecimento qu√≠mico');
                } else if (gameState.finalScore >= 60) {
                    scoreElement.className = 'feedback success';
                    scoreElement.textContent = `üëè BOM TRABALHO! Pontua√ß√£o final: ${gameState.finalScore}/100. Miss√£o cumprida!`;
                } else {
                    scoreElement.className = 'feedback error';
                    scoreElement.textContent = `ü§î Pontua√ß√£o final: ${gameState.finalScore}/100. Que tal revisar os conceitos?`;
                }
                
                document.getElementById('showEndingBtn').disabled = false;
            }
        }

        // Ending System
        function showEnding() {
            goToScreen('epilogue');
            
            const endingContent = document.getElementById('endingContent');
            let ending = '';
            
            if (gameState.finalScore >= 90) {
                ending = `
                    <div class="hero-card">
                        <h3>üèÜ FINAL √âPICO: O Mestre da Matrix</h3>
                        <p>Parab√©ns! Voc√™ n√£o apenas salvou o mundo, mas se tornou um verdadeiro Mestre da Matrix Qu√≠mica. Seu conhecimento sobre petr√≥leo, pol√≠meros e radioatividade foi perfeito!</p>
                        <p><strong>Pontua√ß√£o Final: ${gameState.finalScore}/100</strong></p>
                        <p>üåü Voc√™ desbloqueou todos os segredos da qu√≠mica e se tornou uma lenda entre os cientistas!</p>
                    </div>
                `;
            } else if (gameState.finalScore >= 70) {
                ending = `
                    <div class="card" style="background: var(--color-bg-3);">
                        <h3>üéñÔ∏è FINAL HEROICO: O Salvador Cient√≠fico</h3>
                        <p>Excelente trabalho! Voc√™ conseguiu derrotar o v√≠rus qu√≠mico e salvar o planeta. Seu conhecimento s√≥lido em qu√≠mica foi fundamental para o sucesso da miss√£o.</p>
                        <p><strong>Pontua√ß√£o Final: ${gameState.finalScore}/100</strong></p>
                        <p>‚ú® Continue estudando para se tornar um mestre completo!</p>
                    </div>
                `;
            } else if (gameState.finalScore >= 50) {
                ending = `
                    <div class="card" style="background: var(--color-bg-2);">
                        <h3>‚öîÔ∏è FINAL CORAJOSO: O Aprendiz Determinado</h3>
                        <p>Voc√™ mostrou coragem e determina√ß√£o! Embora tenha enfrentado dificuldades, conseguiu contribuir para a miss√£o e aprendeu muito no processo.</p>
                        <p><strong>Pontua√ß√£o Final: ${gameState.finalScore}/100</strong></p>
                        <p>üìö Continue praticando - voc√™ tem potencial para muito mais!</p>
                    </div>
                `;
            } else {
                ending = `
                    <div class="card" style="background: var(--color-bg-4);">
                        <h3>üéì FINAL EDUCATIVO: O Estudante Persistente</h3>
                        <p>Toda jornada de aprendizado tem seus desafios! Voc√™ demonstrou persist√™ncia e coragem para chegar at√© aqui. O importante √© continuar aprendendo.</p>
                        <p><strong>Pontua√ß√£o Final: ${gameState.finalScore}/100</strong></p>
                        <p>üí™ Revisite os conceitos e tente novamente - voc√™ vai conseguir!</p>
                    </div>
                `;
            }
            
            endingContent.innerHTML = ending;
            
            // Show final badges
            showFinalBadges();
        }

        function showFinalBadges() {
            const badgeContainer = document.getElementById('finalBadges');
            const allBadges = {
                explorer: { name: 'üöÄ Explorador Qu√≠mico', desc: 'Iniciou a jornada cient√≠fica' },
                petroleum: { name: 'üõ¢Ô∏è Mestre do Petr√≥leo', desc: 'Dominou a destila√ß√£o fracionada' },
                polymers: { name: 'üß™ Mestre dos Pol√≠meros', desc: 'Compreendeu a polimeriza√ß√£o' },
                radiation: { name: '‚ò¢Ô∏è Guardi√£o Nuclear', desc: 'Dominou a radioatividade' },
                hero: { name: 'üèÜ Her√≥i Cient√≠fico', desc: 'Salvou o mundo com qu√≠mica' }
            };
            
            let badgeHTML = '';
            
            for (let badgeId in allBadges) {
                const badge = allBadges[badgeId];
                const earned = gameState.badges.includes(badgeId);
                
                badgeHTML += `
                    <div class="badge ${earned ? '' : 'locked'}">
                        ${badge.name}
                        <br><small>${badge.desc}</small>
                    </div>
                `;
            }
            
            badgeContainer.innerHTML = badgeHTML;
        }

        // Reflection System
        function saveReflection() {
            const learned = document.getElementById('learned').value;
            const difficult = document.getElementById('difficult').value;
            const strategies = document.getElementById('strategies').value;
            
            if (learned && difficult && strategies) {
                showNotification('üí≠ Reflex√£o salva com sucesso! Parab√©ns pela metacogni√ß√£o.');
                addXP(50);
            } else {
                showNotification('üìù Preencha todos os campos da reflex√£o.', 'error');
            }
        }

        // Utility Functions
        function restartAdventure() {
            // Reset game state
            gameState = {
                currentScreen: 'welcome',
                character: null,
                xp: 0,
                level: 1,
                progress: 0,
                completedActivities: {
                    petroleumVideo: false,
                    petroleumDragDrop: false,
                    polymersVideo: false,
                    polymersQuiz: false,
                    polymersChoice: false,
                    radiationVideo: false,
                    radiationDragDrop: false,
                    halflifeVideo: false,
                    halflifeQuiz: false,
                    nuclearVideo: false,
                    nuclearQuiz: false,
                    finalBattle: false
                },
                badges: [],
                finalScore: 0,
                answers: {
                    petroleum: {},
                    polymers: {},
                    radiation: {},
                    nuclear: {},
                    final: {}
                }
            };
            
            // Reset drag drop state
            dragDropState = {
                petroleum: {
                    correct: {
                        'gasolina': '30-200',
                        'querosene': '150-300', 
                        'diesel': '200-350',
                        'asfalto': '350+'
                    },
                    userAnswers: {}
                },
                radiation: {
                    correct: {
                        'alpha': 'low',
                        'beta': 'medium',
                        'gamma': 'high'
                    },
                    userAnswers: {}
                }
            };
            
            // Reset UI
            updateUI();
            goToScreen('welcome');
            
            // Reset forms and buttons
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            document.querySelectorAll('.feedback').forEach(fb => {
                fb.style.display = 'none';
            });
            
            document.querySelectorAll('.btn').forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
            });
            
            // Re-enable specific disabled buttons
            document.getElementById('startMissionBtn').disabled = true;
            document.getElementById('toPolymersBtn').disabled = true;
            document.getElementById('toRadioactivityBtn').disabled = true;
            document.getElementById('toNuclearBtn').disabled = true;
            document.getElementById('toFinalBtn').disabled = true;
            document.getElementById('showEndingBtn').disabled = true;
            
            showNotification('üîÑ Aventura reiniciada! Boa sorte, cientista!');
        }

        function exportResults() {
            const results = {
                character: gameState.character,
                finalScore: gameState.finalScore,
                xp: gameState.xp,
                level: gameState.level,
                badges: gameState.badges,
                completedActivities: gameState.completedActivities,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(results, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `chemmatrix-results-${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('üìä Resultados exportados com sucesso!');
        }

        // Initialize drag and drop when screens are loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Setup radiation drag drop
            setTimeout(() => {
                setupRadiationDragDrop();
            }, 1000);
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                // Allow ESC key to go back
                const backButton = document.querySelector('.screen.active .btn-secondary');
                if (backButton && backButton.textContent.includes('‚Üê')) {
                    backButton.click();
                }
            }
        });

        // Initialize UI
        updateUI();
    </script>
</body>
</html>